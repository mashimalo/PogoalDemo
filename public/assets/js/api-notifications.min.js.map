{"version":3,"sources":["api-notifications.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"api-notifications.min.js","sourcesContent":["$(function () {\n    // DIV Cache\n    var $body = $(\"body\");\n    var $toolbarNotificationButton = \"#toolbar-notification-button\";\n    var $toolbarNotificationList = \"#toolbar-notification-list\";\n    // var $seeAllNotificationList = \"#see-all-notification-list\";\n    var $toolbarNotificationListChild = \"#toolbar-notification-list li\";\n    var $seeAllNotificationListChild = \"#see-all-notification-list li\";\n    var $toolbarNotificationListChildReadButton = \"#toolbar-notification-list .notification__list__markReadBtn\";\n    var $seeAllNotificationListChildReadButton = \"#see-all-notification-list .notification__list__markReadBtn\";\n    var $toolbarNotificationCounter = \"#toolbar-notification-counter\";\n    var $toolbarNotificationListLoader = \"#toolbar-notification-list-loader\";\n\n    // Action Cache\n    var $notificationMarkAllReadButton = \"[data-action='notification-mark-all-read-button']\";\n    var $notificationMarkRead = \"[data-action='notification-mark-read']\";\n\n    // Attributes Cache\n    var $csrf_token = $(\"meta[name=_token]\").attr(\"content\");\n\n    /*--------------------------------------------------------------------------\n     | Toolbar Notification List\n     --------------------------------------------------------------------------*/\n    $body.on(\"click\", $toolbarNotificationButton, function () {\n\n        // Run Ajax if Parent is Closed\n        if (!$($toolbarNotificationButton).parent().hasClass(\"open\")) {\n\n            // Empty Notification List\n            $($toolbarNotificationList).empty();\n\n            // Add Loading to Notification List\n            $($toolbarNotificationList).append(\n                '<li id=\"toolbar-notification-list-loader\"><div class=\"notification__list__content loading\">' +\n                '&nbsp;<div class=\"hidden-text\">Loading</div>' +\n                '</div></li>'\n            );\n\n            // AJAX\n            $.ajaxSetup({\n                headers: {\n                    'X-CSRF-TOKEN': $csrf_token\n                }\n            });\n            $.ajax({\n                url: \"/notifications\",\n                type: \"GET\",\n                dataType: \"json\",\n                success: function (data) {\n\n                    // Empty Notification List\n                    $($toolbarNotificationList).empty();\n\n                    // Update Notification Counter\n                    if (data.newNotifications > 0) {\n                        $($toolbarNotificationCounter).removeClass(\"hidden\");\n                    } else if (data.newNotifications < 1) {\n                        $($toolbarNotificationCounter).addClass(\"hidden\");\n                    }\n                    $($toolbarNotificationCounter).html(data.newNotifications);\n\n                    // Notification List Loop\n                    $.each(data.json, function (index, item) {\n\n                        // Data Cache\n                        var $data = {\n                            id: item.id,\n                            user_id: item.user_id,\n                            message_data: item.message_data,\n                            notification_link: item.notification_link,\n                            read: item.read,\n                            created_at: item.created_at,\n                            updated_at: item.updated_at,\n                        };\n\n                        // Notification Status Statement\n                        if (item.read == 0) {\n                            $data[\"new_notification\"] = \"notification--new\";\n                            $data[\"toolbar_notification_status\"] = \"new\";\n                            $data[\"toolbar_notification_button_title\"] = \"Mark Read\";\n                            $data[\"toolbar_notification_button_icon\"] = \"circle\";\n                        } else if (item.read == 1) {\n                            $data[\"toolbar_notification_status\"] = \"read\";\n                            $data[\"toolbar_notification_button_title\"] = \"Read\";\n                            $data[\"toolbar_notification_button_icon\"] = \"dot-fill\";\n                        }\n\n                        // Get Toolbar Notification template\n                        $.get('/api/toolbar-notification-list-v000011.template', function (template) {\n                            var $toolbarNotificationTemplate = Mustache.render(template, $data);\n\n                            // prepend it to #toolbar-notification-list\n                            $($toolbarNotificationList).append($toolbarNotificationTemplate);\n\n                        });\n\n                    });\n\n                    // Remove Loader\n                    $($toolbarNotificationListLoader).remove();\n                }\n            });\n\n        }\n    });\n\n    /*--------------------------------------------------------------------------\n     | Toolbar Notification Mark Read\n     --------------------------------------------------------------------------*/\n    $body.on(\"click\", $notificationMarkRead, function (event) {\n\n        // Cache\n        var $this = $(this);\n        var $data_notification_id = $this.parent().attr(\"data-notification-id\");\n        var $data_notification_status = $this.parent().attr(\"data-notification-status\");\n\n        // Prevent Dropdown Closed\n        event.stopPropagation();\n\n        // Check Notification Status\n        if ($data_notification_status === \"new\") {\n\n            // Disable inputs to prevent multiple submit\n            $this.attr('disabled', 'disabled');\n\n            // AJAX - Mark Read\n            $.ajaxSetup({\n                headers: {\n                    'X-CSRF-TOKEN': $csrf_token\n                }\n            });\n            $.ajax({\n                url: \"/notifications/\" + $data_notification_id + \"/read\",\n                type: \"PATCH\",\n                success: function () {\n\n                    // Remove .Notification--new Class\n                    $this.parent().removeClass(\"notification--new\");\n\n                    // Change Notification Status\n                    $this.parent().attr(\"data-notification-status\", \"read\");\n\n                    // Change Read Button Title\n                    $this.prop('title', 'Read');\n\n                    // Change Read Button Icon\n                    $this.find(\".icon\").removeClass(\"icon-circle\");\n                    $this.find(\".icon\").addClass(\"icon-dot-fill\");\n\n                    // Update Toolbar Notification Counter\n                    var $currentTotal = $($toolbarNotificationCounter).html();\n                    var $newTotal = $currentTotal - 1;\n                    $($toolbarNotificationCounter).html($newTotal);\n                    if ($newTotal < 1) {\n                        $($toolbarNotificationCounter).addClass(\"hidden\");\n                    }\n\n                    // Remove disabled attribute\n                    $this.removeAttr(\"disabled\");\n\n                },\n                error: function () {\n                    // Remove disabled attribute\n                    $this.removeAttr(\"disabled\");\n                }\n            });\n\n        }\n\n    });\n\n    /*--------------------------------------------------------------------------\n     | Toolbar Notification Mark All Read\n     --------------------------------------------------------------------------*/\n    $body.on(\"click\", $notificationMarkAllReadButton, function (event) {\n\n        // Cache\n        var $this = $(this);\n\n        // Add loading animation\n        $this.addClass(\"loading loading--medium loading--white\");\n\n        // Prevent Dropdown Closed\n        event.stopPropagation();\n\n        // Disable inputs to prevent multiple submit\n        $this.attr('disabled', 'disabled');\n\n        // AJAX - Mark Read\n        $.ajaxSetup({\n            headers: {\n                'X-CSRF-TOKEN': $csrf_token\n            }\n        });\n        $.ajax({\n            url: \"/notifications/readall\",\n            type: \"PATCH\",\n            success: function () {\n\n                // Update Notification Counter\n                $($toolbarNotificationCounter).addClass(\"hidden\");\n                $($toolbarNotificationCounter).html(\"0\");\n\n                // Remove .Notification--new Class\n                $($toolbarNotificationListChild).removeClass(\"notification--new\");\n                $($seeAllNotificationListChild).removeClass(\"notification--new\");\n\n                // Change Notification Status\n                $($toolbarNotificationListChild).attr(\"data-notification-status\", \"read\");\n                $($seeAllNotificationListChild).attr(\"data-notification-status\", \"read\");\n\n                // Change Read Button Title\n                $($toolbarNotificationListChildReadButton).prop('title', 'Read');\n                $($seeAllNotificationListChildReadButton).prop('title', 'Read');\n\n                // Change Read Button Icon\n                $($toolbarNotificationListChildReadButton).find(\".icon\").removeClass(\"icon-circle\");\n                $($toolbarNotificationListChildReadButton).find(\".icon\").addClass(\"icon-dot-fill\");\n                $($seeAllNotificationListChildReadButton).find(\".icon\").removeClass(\"icon-circle\");\n                $($seeAllNotificationListChildReadButton).find(\".icon\").addClass(\"icon-dot-fill\");\n\n                // Remove loading animation\n                $this.removeClass(\"loading loading--medium loading--white\");\n\n                // Remove disabled attribute\n                $this.removeAttr(\"disabled\");\n\n            },\n            error: function () {\n\n                // Remove disabled attribute\n                $this.removeAttr(\"disabled\");\n\n            }\n        });\n\n    });\n\n    /*--------------------------------------------------------------------------\n     | Toolbar Notification Counter Auto Update\n     --------------------------------------------------------------------------*/\n    $(window).load(function () {\n\n        setInterval(function () {\n\n            // AJAX\n            $.ajaxSetup({\n                headers: {\n                    'X-CSRF-TOKEN': $csrf_token\n                }\n            });\n            $.ajax({\n                url: \"/notifications\",\n                type: \"GET\",\n                dataType: \"json\",\n                success: function (data) {\n\n                    // Update Notification Counter\n                    if (data.newNotifications > 0) {\n                        $($toolbarNotificationCounter).removeClass(\"hidden\");\n                    }\n\n                    $($toolbarNotificationCounter).html(data.newNotifications);\n                }\n            });\n\n        }, 300000);\n\n    });\n\n});"],"sourceRoot":"/source/"}